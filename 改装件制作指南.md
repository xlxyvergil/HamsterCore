# 改装件制作指南

本指南将详细介绍如何为HamsterCore模组制作完整的改装件，包括JSON配置、模型和材质文件的编写。

## 一、改装件基本结构

一个完整的改装件需要以下文件：

1. **JSON配置文件**：定义改装件的属性、词缀、适用范围等
2. **模型文件**：定义改装件的3D模型
3. **材质文件**：定义改装件的纹理

## 二、JSON配置文件

### 1. 文件路径

JSON配置文件位于：
```
src/main/resources/data/hamstercore/modifications/[改装件ID].json
```

### 2. 配置结构

```json
{
  "variant": "hamstercore:[改装件ID]",
  "weight": 100,
  "dimensions": [],
  "category": "primary",
  "unique": true,
  "rarity": "uncommon",
  "affixes": [
    {
      "type": "hamstercore:cold",
      "name": "cold",
      "value": 0.9,
      "operation": "ADDITION"
    }
  ],
  "use_special_socket": false,
  "mutualExclusionGroups": ["rifle_cold_slug_group"]
}
```

### 3. 配置字段说明

| 字段名 | 类型 | 说明 |
|-------|------|------|
| variant | ResourceLocation | 改装件的唯一标识符 |
| weight | int | 生成权重，数值越大生成概率越高 |
| dimensions | Set<ResourceLocation> | 适用维度，空列表表示所有维度 |
| category | String | 武器类别：primary（主武器）、secondary（副武器）等 |
| unique | boolean | 是否唯一，true表示同一物品只能装一个 |
| rarity | String | 稀有度：common, uncommon, rare, epic, mythic |
| affixes | List<ModificationAffix> | 词缀列表，定义改装件的属性效果 |
| use_special_socket | boolean | 是否使用特殊槽位，true为特殊槽位，false为普通槽位 |
| mutualExclusionGroups | List<String> | 互斥组，同组改装件不能同时安装 |

### 4. 词缀配置

每个词缀包含以下字段：

| 字段名 | 类型 | 说明 |
|-------|------|------|
| type | String | 词缀类型，命名空间+属性id，如"hamstercore:cold" |
| name | String | 属性显示名称，如"cold" |
| value | double | 属性值 |
| operation | String | 操作类型：ADDITION, MULTIPLY_BASE, MULTIPLY_TOTAL |

## 三、模型文件

### 1. 文件路径

模型文件位于：
```
src/main/resources/assets/hamstercore/models/item/modification/[改装件ID].json
```

### 2. 模型结构

```json
{
  "parent": "item/generated",
  "textures": {
    "layer0": "hamstercore:textures/item/modification/[改装件ID]"
  }
}
```

### 3. 高级模型配置

如果需要更复杂的模型，可以使用自定义模型：

```json
{
  "parent": "item/generated",
  "textures": {
    "layer0": "hamstercore:textures/item/modification/[改装件ID]_base",
    "layer1": "hamstercore:textures/item/modification/[改装件ID]_overlay"
  },
  "overrides": [
    {
      "predicate": {
        "custom_model_data": 1
      },
      "model": "hamstercore:item/modification/[改装件ID]_variant"
    }
  ]
}
```

## 四、材质文件

### 1. 文件路径

材质文件位于：
```
src/main/resources/assets/hamstercore/textures/item/modification/[改装件ID].png
```

### 2. 材质要求

- 推荐分辨率：16x16或32x32
- 格式：PNG
- 支持透明通道

### 3. 材质命名规范

- 基础材质：`[改装件ID].png`
- 叠加材质：`[改装件ID]_overlay.png`
- 变体材质：`[改装件ID]_variant.png`

## 五、互斥组使用

### 1. 基本用法

将需要互斥的改装件放入同一个互斥组：

```json
// rifle_cold_slug.json
"mutualExclusionGroups": ["rifle_cold_slug_group"]

// rifle_cold_slug_prime.json
"mutualExclusionGroups": ["rifle_cold_slug_group"]
```

### 2. 多组互斥

一个改装件可以属于多个互斥组：

```json
"mutualExclusionGroups": ["group1", "group2"]
```

### 3. 无互斥改装件

对于没有互斥限制的改装件，可以不填写该字段或填写空列表：

```json
// 方式一：不填写该字段
{ /* 其他配置 */ }

// 方式二：填写空列表
"mutualExclusionGroups": []
```

## 六、示例配置

### 1. 完整的改装件配置

**JSON配置文件** (`data/hamstercore/modifications/rifle_cold_slug.json`):

```json
{
  "variant": "hamstercore:rifle_cold_slug",
  "weight": 100,
  "dimensions": [],
  "category": "primary",
  "unique": true,
  "rarity": "uncommon",
  "affixes": [
    {
      "type": "hamstercore:cold",
      "name": "cold",
      "value": 0.9,
      "operation": "ADDITION"
    }
  ],
  "use_special_socket": false,
  "mutualExclusionGroups": ["rifle_cold_slug_group"]
}
```

**模型文件** (`assets/hamstercore/models/item/modification/rifle_cold_slug.json`):

```json
{
  "parent": "item/generated",
  "textures": {
    "layer0": "hamstercore:textures/item/modification/rifle_cold_slug"
  }
}
```

**材质文件**：
- `assets/hamstercore/textures/item/modification/rifle_cold_slug.png`

## 七、可应用的属性列表

根据HamsterCore和TaczAttributeAdd (TAA) 的属性系统，以下是可应用的属性列表：

### HamsterCore 属性

#### 基础属性
- `hamstercore:armor` - HC护甲值
- `hamstercore:shield` - 护盾值
- `hamstercore:regen_rate` - 护盾再生速率
- `hamstercore:regen_delay` - 护盾再生延迟（毫秒）
- `hamstercore:depleted_regen_delay` - 护盾耗尽再生延迟（毫秒）
- `hamstercore:immunity_time` - 护盾免疫时间（毫秒）

#### 元素伤害属性
- `hamstercore:impact` - 冲击伤害
- `hamstercore:puncture` - 穿刺伤害
- `hamstercore:slash` - 切割伤害
- `hamstercore:cold` - 冰冻伤害
- `hamstercore:electricity` - 电击伤害
- `hamstercore:heat` - 火焰伤害
- `hamstercore:toxin` - 毒素伤害
- `hamstercore:blast` - 爆炸伤害
- `hamstercore:corrosive` - 腐蚀伤害
- `hamstercore:gas` - 毒气伤害
- `hamstercore:magnetic` - 磁力伤害
- `hamstercore:radiation` - 辐射伤害
- `hamstercore:viral` - 病毒伤害

#### 特殊属性
- `attributeslib:crit_chance` - 暴击率 (基础值 0.05 = 5% 暴击率)
- `attributeslib:crit_damage` - 暴击伤害 (基础值 1.5 = 150% 暴击伤害)
- `hamstercore:trigger_chance` - 触发率

### TaczAttributeAdd (TAA) 属性

#### 瞄准与精度相关
- `taa:ads_time` - 瞄准时间
- `taa:inaccuracy` - 不准确度（散布）

#### 伤害相关
- `taa:bullet_gundamage` - 通用枪械伤害加成
- `taa:bullet_gundamage_pistol` - 手枪伤害加成
- `taa:bullet_gundamage_rifle` - 步枪伤害加成
- `taa:bullet_gundamage_shotgun` - 霰弹枪伤害加成
- `taa:bullet_gundamage_sniper` - 狙击枪伤害加成
- `taa:bullet_gundamage_smg` - 冲锋枪伤害加成
- `taa:bullet_gundamage_lmg` - 机枪伤害加成
- `taa:bullet_gundamage_rpg` - 火箭筒伤害加成
- `attributeslib:arrow_damage` - 远程伤害加成

#### 弹药与射击相关
- `taa:bullet_count` - 弹头数量
- `taa:ammo_speed` - 弹药速度
- `taa:pierce` - 穿透能力
- `taa:magazine_capacity` - 弹匣容量
- `taa:reload_time` - 换弹速度

#### 射速与后坐力相关
- `taa:rounds_per_minute` - 每分钟射速
- `taa:recoil` - 后坐力
- `taa:knockback` - 击退效果

#### 特殊效果相关
- `taa:effective_range` - 有效射程
- `taa:headshot_multiplier` - 爆头倍数
- `taa:armor_ignore` - 护甲穿透
- `taa:ignitefire` - 点燃效果
- `taa:move_speed` - 移动速度

#### 爆炸相关
- `taa:explosion_radius` - 爆炸半径
- `taa:explosion_damage` - 爆炸伤害
- `taa:explosion_knockbacknew` - 爆炸击退
- `taa:explosion_destroy_blocknew` - 爆炸破坏方块
- `taa:explosion_delay` - 爆炸延迟

#### 其他
- `taa:silencenew` - 消音效果
- `taa:weight` - 重量
- `taa:melee_damage` - 近战伤害
- `taa:melee_distance` - 近战距离

## 八、注意事项

1. **改装件ID命名规范**：使用小写字母、数字和下划线，避免使用特殊字符
2. **词缀类型**：确保使用已注册的词缀类型，参考上面的属性列表
3. **适用类型**：根据改装件的设计选择合适的适用武器类型
4. **互斥组命名**：使用有意义的组名，便于管理
5. **材质分辨率**：保持一致的分辨率，推荐32x32
6. **模型复杂度**：避免过于复杂的模型，影响游戏性能

## 九、测试与调试

1. **构建模组**：使用`./gradlew build`命令构建模组
2. **运行游戏**：在开发环境中运行游戏进行测试
3. **检查日志**：查看游戏日志，排查配置错误
4. **调试命令**：使用模组提供的调试命令查看改装件信息

## 十、最佳实践

1. **模块化设计**：将相关的改装件放在同一互斥组中
2. **平衡设计**：根据稀有度调整属性值，保持游戏平衡性
3. **清晰命名**：使用清晰的命名规则，便于维护
4. **文档记录**：为每个改装件编写简要说明，便于其他开发者理解
5. **定期更新**：根据游戏版本和模组更新，及时调整改装件配置

通过遵循本指南，你可以创建出功能完整、设计合理的改装件，丰富游戏的玩法和策略性。